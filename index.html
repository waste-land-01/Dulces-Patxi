import React, { useState, useMemo } from 'react';
import { Search, Star, Clock, Salad, Utensils } from 'lucide-react';

// --- Estructura de Estado de Filtros (Simplificada) ---
const initialFilterState = {
    totalTime: { min: 10, max: 240 },
    ingredientCount: { min: 3, max: 20 },
    difficulty: [1, 2, 3, 4, 5],
};

// --- Componente para mostrar las estrellas de dificultad ---
const DifficultyStars = ({ rating }) => {
    return (
        <div className="flex items-center space-x-0.5">
            {[1, 2, 3, 4, 5].map((star) => (
                <Star
                    key={star}
                    className={`w-4 h-4 transition-colors duration-150 ${
                        star <= rating ? 'text-yellow-400 fill-yellow-400' : 'text-gray-300'
                    }`}
                />
            ))}
        </div>
    );
};

// --- Componente de Tarjeta de Receta (Mock para visualización) ---
const RecipeCard = ({ recipe }) => (
    <div className="bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 overflow-hidden border border-gray-100">
        <div className="relative h-48 sm:h-56">
            <img 
                src={recipe.image} 
                alt={recipe.title} 
                className="w-full h-full object-cover" 
                onError={(e) => { e.target.onerror = null; e.target.src = "https://placehold.co/600x400/1E3A8A/FFFFFF?text=Receta"; }}
            />
            <div className="absolute top-3 right-3 bg-indigo-600 text-white text-xs font-semibold px-3 py-1 rounded-full shadow-md flex items-center">
                <Clock className="w-3 h-3 mr-1" />
                {recipe.totalTime} min
            </div>
        </div>
        <div className="p-4 sm:p-5">
            <h3 className="text-xl font-bold text-gray-800 mb-1 line-clamp-2">{recipe.title}</h3>
            <div className="flex items-center justify-between mb-3">
                <DifficultyStars rating={recipe.difficulty} />
                <span className="text-sm font-medium text-indigo-600">{recipe.category}</span>
            </div>
            <div className="flex justify-between text-sm text-gray-600 border-t border-gray-100 pt-3">
                <div className="flex items-center">
                    <Utensils className="w-4 h-4 mr-1 text-gray-400" />
                    <span>Prep: {recipe.prepTime} min</span>
                </div>
                <div className="flex items-center">
                    <Salad className="w-4 h-4 mr-1 text-gray-400" />
                    <span>Ingr: {recipe.ingredients}</span>
                </div>
            </div>
        </div>
    </div>
);

// --- Mock de Recetas para Visualización ---
const mockRecipes = [
    { id: 1, title: "Lomo Saltado Peruano Auténtico", category: "Carnes", prepTime: 20, cookingTime: 25, totalTime: 45, ingredients: 8, difficulty: 4, rating: 4.5, image: "https://placehold.co/600x400/EF4444/FFFFFF?text=Lomo+Saltado", tags: ["carne", "peruano", "salado"] },
    { id: 2, title: "Sopa de Tomate y Albahaca Rápida", category: "Sopas", prepTime: 10, cookingTime: 15, totalTime: 25, ingredients: 5, difficulty: 2, rating: 3.8, image: "https://placehold.co/600x400/10B981/FFFFFF?text=Sopa+Tomate", tags: ["vegetariano", "sopa", "rápida"] },
    { id: 3, title: "Curry de Garbanzos y Espinacas Vegano", category: "Vegetariano", prepTime: 15, cookingTime: 30, totalTime: 45, ingredients: 12, difficulty: 3, rating: 4.2, image: "https://placehold.co/600x400/3B82F6/FFFFFF?text=Curry+Vegano", tags: ["vegano", "curry", "salado"] },
    { id: 4, title: "Tarta de Manzana Clásica Holandesa", category: "Postres", prepTime: 30, cookingTime: 60, totalTime: 90, ingredients: 10, difficulty: 5, rating: 4.9, image: "https://placehold.co/600x400/F97316/FFFFFF?text=Tarta+Manzana", tags: ["postre", "dulce", "horneado"] },
];


export default function App() {
    // Estado del texto de búsqueda
    const [searchTerm, setSearchTerm] = useState('');
    
    // --- Lógica de filtrado (useMemo) ---
    const filteredRecipes = useMemo(() => {
        let results = mockRecipes;

        // 1. Filtrado por texto de búsqueda (Título y Tags)
        if (searchTerm) {
            const term = searchTerm.toLowerCase();
            results = results.filter(recipe => 
                recipe.title.toLowerCase().includes(term) ||
                recipe.tags.some(tag => tag.includes(term))
            );
        }
        return results;
    }, [searchTerm]);


    return (
        <div className="min-h-screen bg-gray-50 font-sans">
            {/* Header / Barra de Búsqueda Fija */}
            <header className="bg-white sticky top-0 z-10 shadow-lg p-4 sm:p-6 border-b border-indigo-100">
                <div className="max-w-4xl mx-auto flex flex-col space-y-4">
                    
                    <h1 className="text-3xl font-extrabold text-center text-indigo-700">
                        Buscador Inteligente <span className="text-pink-500">🧠</span>
                    </h1>

                    {/* Campo de Búsqueda de Texto */}
                    <div className="relative flex-grow">
                        <input
                            type="text"
                            placeholder="Buscar por nombre de receta, ingrediente o categoría..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                            className="w-full py-3 pl-10 pr-4 border border-gray-300 rounded-full focus:ring-indigo-500 focus:border-indigo-500 transition duration-150 shadow-sm text-gray-700"
                        />
                        <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" />
                    </div>
                    
                    {/* Sección donde irán los botones de filtro (vacía por ahora) */}
                    <div className="h-6">
                        {/* Espacio para los botones */}
                    </div>

                </div>
            </header>

            <main className="max-w-4xl mx-auto p-4 sm:p-6 pt-0">
                
                {/* Indicador de Filtros Aplicados y Reset */}
                <div className="flex justify-between items-center py-4 mt-6 border-b border-gray-200">
                    <h2 className="text-2xl font-bold text-gray-800">
                        Resultados de la Búsqueda 
                        <span className="ml-2 text-indigo-600">({filteredRecipes.length} recetas)</span>
                    </h2>
                </div>


                {/* Contenedor de Recetas */}
                <div className="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-6 pb-12">
                    {filteredRecipes.length > 0 ? (
                        filteredRecipes.map(recipe => (
                            <RecipeCard key={recipe.id} recipe={recipe} />
                        ))
                    ) : (
                        <div className="col-span-1 sm:col-span-2 text-center py-10 bg-white rounded-xl shadow-md border border-gray-100">
                            <p className="text-lg text-gray-500 font-medium">
                                No se encontraron recetas que coincidan con la búsqueda.
                            </p>
                        </div>
                    )}
                </div>

            </main>
        </div>
    );
}
